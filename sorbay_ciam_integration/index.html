
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../sorbay_ciam/" rel="prev"/>
<link href="../sorbay_ciam_api/" rel="next"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.9" name="generator"/>
<title>Integration - USP Core WAAP documentation</title>
<link href="../assets/stylesheets/main.f2e4d321.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../assets/stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#integration-of-a-sorbay_ciam-service">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="USP Core WAAP documentation" class="md-header__button md-logo" data-md-component="logo" href=".." title="USP Core WAAP documentation">
<img alt="logo" src="../assets/images/sorbay-blue-white.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            USP Core WAAP documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Integration
            
          </span>
</div>
</div>
</div>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="USP Core WAAP documentation" class="md-nav__button md-logo" data-md-component="logo" href=".." title="USP Core WAAP documentation">
<img alt="logo" src="../assets/images/sorbay-blue-white.png"/>
</a>
    USP Core WAAP documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
<span class="md-ellipsis">
    Welcome
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../profile/">
<span class="md-ellipsis">
    Profile
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../workspaces/">
<span class="md-ellipsis">
    Workspaces
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Services
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Services
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../services/">
<span class="md-ellipsis">
    About
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    sorbay_ciam
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            sorbay_ciam
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../sorbay_ciam/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Integration
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Integration
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-the-sorbay_ciam-service">
<span class="md-ellipsis">
      Configure the sorbay_ciam service
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run-the-docker-demo-ui">
<span class="md-ellipsis">
      Run the Docker Demo UI
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sorbay_ciam_api/">
<span class="md-ellipsis">
    API
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
<span class="md-ellipsis">
    sorbay_risk
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
            sorbay_risk
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../sorbay_risk/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sorbay_risk_configuration/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sorbay_risk_integration/">
<span class="md-ellipsis">
    Integration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sorbay_risk_api/">
<span class="md-ellipsis">
    API
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../members/">
<span class="md-ellipsis">
    Members
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../settings/">
<span class="md-ellipsis">
    Settings
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../help/">
<span class="md-ellipsis">
    Help
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-the-sorbay_ciam-service">
<span class="md-ellipsis">
      Configure the sorbay_ciam service
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run-the-docker-demo-ui">
<span class="md-ellipsis">
      Run the Docker Demo UI
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="integration-of-a-sorbay_ciam-service">Integration of a sorbay_ciam service</h1>
<p>This guide will show you how to integrate your service into sorbay_ciam using our demo ui application.</p>
<p>Let's assume that your domain name is "example.com" and you have already created a service with the name "my-ciam-service".</p>
<h2 id="configure-the-sorbay_ciam-service">Configure the sorbay_ciam service</h2>
<p>Navigate to the "Settings" of your service, then go to the "Pages" tab.</p>
<p>Configure the "Page Locations" section as follows:</p>
<p><img src="../img/services_pages_locations.png" style="width: 100%; border: 1px; border-style: solid; border-color: lightgray"/></p>
<p>Now scroll down, until you reach the "CORS" and "Custom" sections. Enter the values according to the following illustration.</p>
<p><img src="../img/services_pages_cors_custom.png" style="width: 100%; border: 1px; border-style: solid; border-color: lightgray"/></p>
<p>You will have to create a CNAME record with the DNS provider with which the domain is registered, with the value that's provided in this view.</p>
<p>Self-Service flows such as Login, Registration, Updating Settings support two successful response modes:</p>
<ul>
<li>For browsers of a server-side application, identified by the <code>Accept: text/html header</code>, the response will be a redirection.</li>
<li>For API clients, such as a client-side AJAX application, identified by the <code>Accept: application/json header</code>, the response will be in JSON.</li>
</ul>
<p>The browser redirects work just for regular browser requests. If you are using an API Client, as  mentioned above, the application must redirect the user to the right endpoint in the application. Since our <a href="https://quay.io/usp/sorbay-ciam-self-service:1.0.0">pre-built demo ui container</a> is a client-side application, it is required to provide the locations by means of environmental variables. </p>
<h2 id="run-the-docker-demo-ui">Run the Docker Demo UI</h2>
<p>You can test the sorbay_ciam service with our <a href="https://quay.io/usp/sorbay-ciam-self-service:1.0.0">pre-built demo ui container</a>.</p>
<p>In order to run the container, it must be configured as follows.</p>
<p>Mandatory configuration:
* Define the name for the container <code>&lt;container-name&gt;</code>
* Define the environment variable for the host name for the web server <code>&lt;your-service&gt;.&lt;your-domain&gt;</code>
* Define the environment variable for the API URI <code>&lt;your-domain&gt;</code>
* Map the container port to the host <code>&lt;host-port&gt;</code>
* Mount the server certificate for SSL into the container <code>&lt;absolute-path-to-certificate&gt;</code>
* Mount the server private key for SSL into the container <code>&lt;absolute-path-to-private-key&gt;</code>
* Specify the image version <code>&lt;version&gt;</code></p>
<p>Optional configuration, to be provided as environment variables (e.g. -e LOGIN_URI="<your-landing-page>.<your-domain>"):
* Define the environment variable DEFAULT_URI for the default redirection, which is taken into account, unless overridden by one of the following options.
* Define the environment variable LOGIN_URI for post-login redirection.
* Define the environment variable REGISTRATION_URI for post-registration redirection.
* Define the environment variable SETTINGS_URI for post-settings redirection.
* Define the environment variable VERIFICATION_URI for post-verification redirection.
* Define the environment variable LOGOUT_URI for post-logout redirection.</your-domain></your-landing-page></p>
<p>To run the container use the following command:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>--name<span class="w"> </span>&lt;container-name&gt;<span class="w"> </span>-e<span class="w"> </span><span class="nv">HOST_NAME</span><span class="o">=</span><span class="s2">"&lt;your-service&gt;.&lt;your-domain&gt;"</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">API_URI</span><span class="o">=</span><span class="s2">"&lt;your-domain&gt;"</span><span class="w"> </span>-p<span class="w"> </span>&lt;host-port&gt;:8443<span class="w"> </span>-v<span class="w"> </span>&lt;absolute-path-to-certificate&gt;:/etc/nginx/certs/ssl.crt<span class="w"> </span>-v<span class="w"> </span>&lt;absolute-path-to-private-key&gt;:/etc/nginx/certs/ssl.key<span class="w"> </span>quay.io/usp/sorbay-ciam-self-service:&lt;version&gt;
</code></pre></div>
<p>This is a concrete example according to the settings above. Ensure you provide the server certificate and private key for the demo application.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>--name<span class="w"> </span>sorbay_ciam_demo<span class="w"> </span>-e<span class="w"> </span><span class="nv">HOST_NAME</span><span class="o">=</span><span class="s2">"customer-app.my-ciam-service.example.org"</span><span class="w"> </span>-v<span class="w"> </span>/location/to/my-ciam-service.key:/etc/nginx/certs/ssl.key<span class="w"> </span>-v<span class="w"> </span>/location/to/my-ciam-service.crt:/etc/nginx/certs/ssl.crt<span class="w"> </span>-e<span class="w"> </span><span class="nv">API_URI</span><span class="o">=</span><span class="s2">"https://my-ciam-service.example.org"</span><span class="w"> </span>-p<span class="w"> </span><span class="m">4200</span>:8443<span class="w"> </span>quay.io/usp/sorbay-ciam-self-service:1.0.0
</code></pre></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>